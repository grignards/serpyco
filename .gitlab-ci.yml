stages:
  - test
  - doc

image: python:3.7

before_script:
  - pip install -r requirements.txt

tests-3.6:
  stage: test
  image: python:3.6
  script:
    - python setup.py test

tests-3.7:
  stage: test
  script:
    - python setup.py test

sphinx:
  stage: doc
  script:
    - python setup.py install
    - apt-get update -q -y
    - apt-get install make
    - pip install sphinx sphinx-autodoc-typehints sphinx-rtd-theme sphinxcontrib-websupport
    - make html
    - mv _build/html/ public
  artifacts:
    paths:
    - public
  only:
    - master
